---
import Metrics from '../components/metrics.astro';
import '../styles/global.css';
import Header from '../components/theme/header.tsx';
import Footer from '../components/theme/footer.tsx';
import Akselalert from '../components/mixed/akselalert.tsx';

interface Props {
    title?: string;
    description?: string;
    name?: string;
    fnr?: string;
}

const { title, description, name, fnr } = Astro.props as Props;

function formatFnr(fnr: string): string {
    return fnr.slice(0, 6) + ' ' + fnr.slice(6);
}
const formattedFnr = fnr ? formatFnr(fnr) : '';


function getFirstName(name: string): string {
    return name.split(' ')[0].toLowerCase();
}
const firstName = name ? getFirstName(name) : '';

---

<html lang="no">
<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>Lekk{title ? ` - ${title}` : ''}</title>
    {description && <meta name="description" content={description} />}
    <Metrics />
</head>
<body>
<Header client:load />
<main class="sm:w-5/6 max-w-[80rem] m-auto px-2 sm:px-6 mb-12">
    <h1>{name} (fnr: {formattedFnr})</h1>
    <Akselalert />
    <p class="mt-8 font-semibold">Lekkede opplysninger i URL-sti (eg. /profile/{firstName}):</p>
    <ul class="list-inside list-disc mt-4">
        <li>Navn: {name}</li>
        <li>FNR: {fnr}</li>
    </ul>

    <p class="mt-8 font-semibold">Lekkede opplysninger i URL parametre (eg. ?name={firstName}):</p>
    <ul class="list-inside list-disc mt-4">
        <li>name: {name}</li>
        <li>fnr: {fnr}</li>
        <li>utm_source: {fnr}</li>
        <li>utm_medium: {fnr}</li>
        <li>utm_campaign: {fnr}</li>
    </ul>

    <p class="mt-8 font-semibold">Lekkede opplysninger i meta (definert i nettsidens HEAD):</p>
    <ul class="list-inside list-disc mt-4">
        <li>Title: "Lekk - {name} (fnr: {formattedFnr})"</li>
        <li>Description: "Lekk - {name} (fnr: {formattedFnr})"</li>
    </ul>

    <slot />

    <p class="max-w-prose mb-4 mt-8 font-semibold">Tilkoblede analyseverkt√∏y:</p>
    <ul class="list-inside list-disc">
        <li><a href="https://app.eu.amplitude.com/analytics/nav/space/product-analytics/product-overview?app=100008939">Amplitude</a></li>
        <li><a href="https://umami.ansatt.nav.no/share/pYHYL85MeTxivZtg/leak.ansatt.nav.no">Umami</a></li>
    </ul>
</main>
<Footer client:load />
</body>
</html>